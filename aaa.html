
<body>
    <style>
        body {
            background: #faebbb;
        }
        .block_top {
            background: #213f29;
            height: 400px;
            color: #faebbb;
            display: flex;
            justify-content: center;
            align-items: center;
            margin-bottom: 100px;
            margin-top: 50px;
            border-radius: 50px;
        }
        .next_block {
            background: #213f29;
            height: 400px;
            color: #faebbb;
            display: flex;
            justify-content: center;
            align-items: center;
            margin-bottom: 50px;
            margin-top: 150px;
            border-radius: 50px;
        }
        .cards {
            position: relative;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 70vh;
            margin-bottom: 90px;
        }
        .custom-card {
            position: absolute;
            width: 100%;
            top: 0px;
            height: 70vh;
            background-color: #213f29;
            color: #faebbb;
            margin-bottom: 50px;
            display: flex;
            justify-content: center;
            align-items: center;
            border-radius: 50px;
            box-shadow: 0 0 30px 0 rgba(0, 0, 0, 0.2);
        }
        .card1 {
        }
        .card2 {
            top: 40px;
        }
        .card3 {
            top: 80px;
        }
        .opacity {
            -moz-transition: 0.4s ease;
            -ms-transition: 0.4s ease;
            -o-transition: 0.4s ease;
            transition: 0.4s ease;
            -webkit-transition: 0.4s ease;
            opacity: 0.6;
        }
        .scale {
            moz-transition: 0.4s ease;
            -ms-transition: 0.4s ease;
            -o-transition: 0.4s ease;
            transition: 0.4s ease;
            -webkit-transition: 0.4s ease;
            width: 95%;
        }
        .nav {
            display: block;
            position: absolute;
            left: 30px;
            top: 45%;
            z-index: 10;
        }
        .nav li {
            padding: 2px;
        }
        .nav li a {
            text-decoration: none;
        }
        .nav .circle {
            border: 1px solid #faebbb;
            color: #faebbb;
            width: 25px;
            height: 25px;
            text-align: center;
            border-radius: 25px;
            -moz-transition: 0.4s ease;
            -ms-transition: 0.4s ease;
            -o-transition: 0.4s ease;
            transition: 0.4s ease;
            -webkit-transition: 0.4s ease;
        }
        .nav .active {
            background: #faebbb;
            color: #213f29;
        }
    </style>

    <div class="container">
        <div class="row">
            <div class="col-12">
                <div class="block_top">
                    <h1>Block Header</h1>
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col-12">
                <div class="cards">
                    <ul class="nav">
                        <li>
                            <a href="#card1"
                                ><div class="circle active 1">1</div></a
                            >
                        </li>
                        <li>
                            <a href="#card2"><div class="circle 2">2</div></a>
                        </li>
                        <li>
                            <a href="#card3"><div class="circle 3">3</div></a>
                        </li>
                    </ul>

                    <div class="custom-card card1" id="1" style="z-index: 2">
                        <h1>Slide 1</h1>
                    </div>
                    <div class="custom-card card2" id="2" style="z-index: 3">
                        <h1>Slide 2</h1>
                    </div>
                    <div class="custom-card card3" id="3" style="z-index: 4">
                        <h1>Slide 3</h1>
                    </div>
                </div>
            </div>
        </div>

        <div class="row">
            <div class="col-12">
                <div class="next_block"><h1>End content</h1></div>
            </div>
        </div>
    </div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.10.4/gsap.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/ScrollTrigger/1.0.6/ScrollTrigger.min.js" integrity="sha512-+LXqbM6YLduaaxq6kNcjMsQgZQUTdZp7FTaArWYFt1nxyFKlQSMdIF/WQ/VgsReERwRD8w/9H9cahFx25UDd+g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script>
        gsap.registerPlugin(ScrollTrigger, ScrollToPlugin);

        //let links = gsap.utils.toArray("nav a");

        let tl = gsap.timeline({
            scrollTrigger: {
                trigger: ".cards",
                pin: true,
                pinSpacing: true,
                markers: true,
                start: "top-=120px top", // when the top of the trigger hits the top of the viewport
                end: "+=2000", // end after scrolling 1000px beyond the start
                scrub: 1, // smooth scrubbing, takes 1 second to "catch up" to the scrollbar
            },
        });
        tl.addLabel("card1");
        tl.to(".card1", {
            yPercent: 0,
            opacity: 1,
        });

        tl.from(".card2", {
            yPercent: 75,
            opacity: 0,
        });
        tl.addLabel("card2");
        // set the active section based on the direction, and position it part-way through the transition because that's more intuitive
        tl.add(
            () => setActiveNav(tl.scrollTrigger.direction > 0 ? 1 : 0),
            "-=0.15"
        );
        tl.to(
            ".card1",
            {
                scale: 0.95,
                yPercent: -0.5,
                opacity: 0.7,
            },
            "-=0.3"
        );

        tl.to(".card2", {
            yPercent: 0,
            opacity: 1,
        });

        tl.from(".card3", {
            yPercent: 75,
            opacity: 0,
        });
        tl.addLabel("card3");
        tl.add(
            () => setActiveNav(tl.scrollTrigger.direction > 0 ? 2 : 1),
            "-=0.15"
        );

        tl.to(
            ".card2",
            {
                scale: 0.98,
                yPercent: -0.4,
                opacity: 0.7,
            },
            "-=0.3"
        );

        tl.to(".card3", {
            yPercent: 0,
            opacity: 1,
        });

        tl.to(".card3", {});

        gsap.utils.toArray(".nav a").forEach((a, i) => {
            a.addEventListener("click", (e) => {
                e.preventDefault();
                let pad = i === 0 ? 0 : tl.scrollTrigger.direction > 0 ? 2 : -2;
                gsap.to(window, {
                    scrollTo: labelToScroll(tl, "card" + (i + 1)) + pad,
                });
            });
        });

        function labelToScroll(timeline, label) {
            let st = timeline.scrollTrigger,
                progress = timeline.labels[label] / timeline.duration();
            return st.start + (st.end - st.start) * progress;
        }
        let circles = gsap.utils.toArray(".nav .circle");

        function setActiveNav(index) {
            circles.forEach((circle, i) =>
                circle.classList[i === index ? "add" : "remove"]("active")
            );
        }
    </script>
</body>
